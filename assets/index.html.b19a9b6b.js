import{_ as l,r as p,o as u,c as i,d as a,w as t,a as n,b as s}from"./app.26c798e2.js";const r={},k=n("h2",{id:"项目开始",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#项目开始","aria-hidden":"true"},"#"),s(" 项目开始")],-1),d=n("ul",null,[n("li",null,[n("code",null,"yarn init -y"),s(" 初始化 "),n("code",null,"package.json")]),n("li",null,[s("或者 使用 "),n("code",null,"npm install koa-generator -g"),s(" 生成项目 "),n("code",null,"koa2 koa-restful-api")])],-1),m=n("div",{class:"language-json line-numbers-mode","data-ext":"json"},[n("pre",{class:"language-json"},[n("code",null,[n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"koa2_restful"'),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token property"},'"version"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"1.0.0"'),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token property"},'"main"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"index.js"'),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token property"},'"license"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"MIT"'),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token property"},'"scripts"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"dev"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"cross-env NODE_ENV=development nodemon app"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"start"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"cross-env NODE_ENV=production node app"'),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token property"},'"dependencies"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"jsonwebtoken"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"^8.5.1"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"koa"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"^2.13.4"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"koa-bodyparser"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"^4.3.0"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"koa-json-error"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"^3.1.2"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"koa-jwt"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"^4.0.3"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"koa-parameter"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"^3.0.1"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"koa-router"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"^12.0.0"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"mongoose"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"^6.7.2"'),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token property"},'"devDependencies"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"cross-env"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"^7.0.3"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"nodemon"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"^2.0.20"'),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),b=n("h2",{id:"理解-koa-中间件-洋葱模型",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#理解-koa-中间件-洋葱模型","aria-hidden":"true"},"#"),s(" 理解 koa 中间件 洋葱模型")],-1),v=n("ul",null,[n("li",null,"koa 中间件的执行顺序是洋葱模型，先执行最外层的中间件，然后执行里面的中间件，最后执行最里面的中间件，然后再执行外层的中间件，依次类推，直到最外层的中间件执行完毕。")],-1),y=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" Koa "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" app "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Koa"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token comment"},"// 下一个中间件"),s(`
  `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"2"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token comment"},"// 下一个中间件执行完毕后将执行后面代码"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"'Hello World'"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 中间件2"),s(`
app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"3"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"4"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 中间件3"),s(`
app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"5"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"6"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 1 3 5 6 4 2"),s(`

`),n("span",{class:"token comment"},"// === 中间件 洋葱模型 ==="),s(`

app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"listen"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"3000"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),g=n("h2",{id:"koa-添加路由",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#koa-添加路由","aria-hidden":"true"},"#"),s(" koa 添加路由")],-1),f=n("ul",null,[n("li",null,[n("code",null,"yarn add koa-router")])],-1),w=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" Koa "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" Router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-router'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" bodyParser "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-bodyparser'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(" app "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Koa"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Router"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 模拟用户验证鉴权中间件"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"auth"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("url "),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token string"},"'/users'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"401"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// 用户路由"),s(`
`),n("span",{class:"token keyword"},"const"),s(" userRouter "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Router"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"prefix"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'/user'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 首页"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"'Hello World'"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 用户列表"),s(`
userRouter`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// 设置请求头"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"set"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'Allow'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'GET, POST'"),n("span",{class:"token punctuation"},")"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),s(`
    `),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'tom'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"20"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'jerry'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"18"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"]"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 创建用户"),s(`
userRouter`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"post"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'ctx.request.body'"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s("body"),n("span",{class:"token punctuation"},")"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'tom'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"20"),s(),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 用户详情"),s(`
userRouter`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'tom'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"20"),s(),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 修改用户"),s(`
userRouter`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"put"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'tom2'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"21"),s(),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 删除用户"),s(`
userRouter`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"delete"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// body解析"),s(`
app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"bodyParser"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 注册路由"),s(`
app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),s("router"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"routes"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 注册用户路由"),s(`
app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),s("userRouter"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"routes"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),s("userRouter"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"allowedMethods"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// http options"),s(`
`),n("span",{class:"token comment"},"// 检测服务器所支持的http请求方法"),s(`
`),n("span",{class:"token comment"},"// CORS中的预检请求"),s(`
`),n("span",{class:"token comment"},"// allowMethods: 用于响应OPTIONS请求"),s(`
`),n("span",{class:"token comment"},"// 相应的请求方法不在路由中时，返回405 （不允许）例如： delete 请求 没有实现"),s(`
`),n("span",{class:"token comment"},"// 相应的请求方法在路由中，但是没有对应的处理函数时，返回501 （未实现）例如：link 请求"),s(`

`),n("span",{class:"token comment"},"// 获取http请求参数"),s(`
`),n("span",{class:"token comment"},"// 1. query 如：http://localhost:3000/user?id=1&name=2"),s(`
`),n("span",{class:"token comment"},"// 2. params 如：http://localhost:3000/user/1"),s(`
`),n("span",{class:"token comment"},"// 3. body 如：post请求 {name: 'tom', age: 20}"),s(`
`),n("span",{class:"token comment"},"// 4. header 如：Authorization Bearer token"),s(`

`),n("span",{class:"token comment"},"// 发送http响应"),s(`
`),n("span",{class:"token comment"},"// 1. 发送 status 例如： 200/400等"),s(`
`),n("span",{class:"token comment"},"// 2. 发送 body 例如： {name: 'tom', age: 20}"),s(`
`),n("span",{class:"token comment"},"// 3. 发送 header 例如： Content-Type: application/json"),s(`

app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"listen"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"3000"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),h=n("h2",{id:"目录重构",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#目录重构","aria-hidden":"true"},"#"),s(" 目录重构")],-1),x=n("ul",null,[n("li",null,"routes 目录放路由文件"),n("li",null,"controllers 目录放控制器文件"),n("li",null,[n("code",null,"koa-parameter"),s(" 参数校验")]),n("li",null,[n("code",null,"koa-json-error"),s(" 错误处理")])],-1),_=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" Koa "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" bodyParser "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-bodyparser'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" parameter "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-parameter'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" app "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Koa"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'./routes'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// koa-json-error"),s(`
app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),s(`
  `),n("span",{class:"token function"},"error"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token function-variable function"},"postFormat"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("e"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(" stack"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token operator"},"..."),s("rest "),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(`
      process`),n("span",{class:"token punctuation"},"."),s("env"),n("span",{class:"token punctuation"},"."),n("span",{class:"token constant"},"NODE_ENV"),s(),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token string"},"'production'"),s(),n("span",{class:"token operator"},"?"),s(" rest "),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(" stack"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token operator"},"..."),s("rest "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// koa-bodyparser 解析请求体"),s(`
app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"bodyParser"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// koa-parameter 参数校验"),s(`
app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"parameter"),n("span",{class:"token punctuation"},"("),s("app"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 注册路由"),s(`
`),n("span",{class:"token function"},"router"),n("span",{class:"token punctuation"},"("),s("app"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 异常状况有哪些？"),s(`
`),n("span",{class:"token comment"},"// 1. 404 Not Found 412 Precondition Failed (先决条件失败) 422 Unprocessable Entity （无法处理的实体，参数格式不对）"),s(`
`),n("span",{class:"token comment"},"// 2. 500 服务器错误 运行时错误"),s(`
`),n("span",{class:"token comment"},"// 3. 401 未授权"),s(`
`),n("span",{class:"token comment"},"// 4. 403 禁止访问"),s(`
`),n("span",{class:"token comment"},"// 5. 400 Bad Request 请求参数错误"),s(`
`),n("span",{class:"token comment"},"// 6. 405 Method Not Allowed 请求方法不被允许"),s(`
`),n("span",{class:"token comment"},"// 7. 406 Not Acceptable 请求的资源的内容特性无法满足请求头中的条件，因而无法生成响应实体"),s(`
`),n("span",{class:"token comment"},"// 8. 409 Conflict 通常是由于资源的当前状态和请求的条件冲突造成的"),s(`

`),n("span",{class:"token comment"},"// jwt vs session"),s(`
`),n("span",{class:"token comment"},"// 1. jwt 无状态，session 有状态"),s(`
`),n("span",{class:"token comment"},"// 2. jwt 无法在多个服务器之间共享，session 可以"),s(`

`),n("span",{class:"token comment"},"// jwt"),s(`
`),n("span",{class:"token comment"},"// 1. 无状态"),s(`
`),n("span",{class:"token comment"},"// 无状态是指服务器不需要记录用户的状态，每次请求都是独立的，不需要记录上一次的请求信息，也不需要记录用户的登录状态，这样就可以实现服务器的水平扩展，即可以增加服务器的数量来提高服务器的处理能力，而不会影响用户的登录状态。"),s(`
`),n("span",{class:"token comment"},"// 2. 无法在多个服务器之间共享"),s(`

app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"listen"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"3000"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),T=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" fs "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'fs'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 批量导出路由"),s(`
module`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function-variable function"},"exports"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"app"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  fs`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"readdirSync"),n("span",{class:"token punctuation"},"("),s("__dirname"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"file"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("file "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token string"},"'index.js'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" route "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"./"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("file"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),s(`
    app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),s("route"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"routes"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),s("route"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"allowedMethods"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),j=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" Router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-router'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Router"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"prefix"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'/users'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 模拟用户验证鉴权中间件"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"auth"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("url "),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token string"},"'/users'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"401"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// 用户列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// 设置请求头"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"set"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'Allow'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'GET, POST'"),n("span",{class:"token punctuation"},")"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),s(`
    `),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'tom'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"20"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'jerry'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"18"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"]"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 创建用户"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"post"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'ctx.request.body'"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s("body"),n("span",{class:"token punctuation"},")"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'tom'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"20"),s(),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 用户详情"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'tom'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"20"),s(),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 修改用户"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"put"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'tom2'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"21"),s(),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 删除用户"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"delete"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(` router
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),A=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" Router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-router'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Router"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 首页"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"'Hello World'"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(` router
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),q=n("ul",null,[n("li",null,"controllers 使用类文件与路由关联")],-1),E=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// home 控制器"),s(`
`),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"HomeCtl"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"index"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"'Hello World'"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"HomeCtl"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),S=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" Router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-router'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Router"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" index "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../controllers/home'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 首页"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" index"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(` router
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),B=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 用户控制器"),s(`
`),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"UsersCtl"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// 获取用户列表"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// 模拟抛出 500 错误"),s(`
    `),n("span",{class:"token comment"},"// a.b"),s(`
    `),n("span",{class:"token comment"},"// ctx.throw(412, '先决条件失败')"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),s(`
      `),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'tom'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"20"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'jerry'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"18"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"]"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 获取用户详情"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'tom'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"20"),s(),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 创建用户"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"create"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// 参数校验"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"verifyParams"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'number'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'tom'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"20"),s(),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 修改用户"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"update"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// 参数校验"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"verifyParams"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'number'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'tom2'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"age"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"21"),s(),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 删除用户"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"del"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"UsersCtl"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),I=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" Router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-router'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(" router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Router"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"prefix"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'/users'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" find"),n("span",{class:"token punctuation"},","),s(" findById"),n("span",{class:"token punctuation"},","),s(" create"),n("span",{class:"token punctuation"},","),s(" update"),n("span",{class:"token punctuation"},","),s(" del "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../controllers/users'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 模拟用户验证鉴权中间件"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"auth"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("url "),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token string"},"'/users'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"401"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// 用户列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" find"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 创建用户"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"post"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" create"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 用户详情"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(" findById"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 修改用户"),s(`
`),n("span",{class:"token comment"},"// 全量修改使用 put"),s(`
`),n("span",{class:"token comment"},"// router.put('/:id', update)"),s(`
`),n("span",{class:"token comment"},"// 部分修改使用 patch"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"patch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" update"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 删除用户"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"delete"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" del"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(` router
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),U=n("h2",{id:"连接数据库-使用-mongoose",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#连接数据库-使用-mongoose","aria-hidden":"true"},"#"),s(" 连接数据库，使用 mongoose")],-1),P={href:"https://www.mongodb.com/",target:"_blank",rel:"noopener noreferrer"},R=n("code",null,"mongodb",-1),C={href:"https://mongoosejs.com/docs/guide.html",target:"_blank",rel:"noopener noreferrer"},L=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[s("module"),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// 数据库配置"),s(`
  `),n("span",{class:"token literal-property property"},"connectStr"),n("span",{class:"token operator"},":"),s(`
    `),n("span",{class:"token string"},"'mongodb+srv://xmllein:<password>@cluster0.9wopstp.mongodb.net/?retryWrites=true&w=majority'"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),H=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" mongoose "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'mongoose'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 连接数据库"),s(`
mongoose`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"connect"),n("span",{class:"token punctuation"},"("),s(`
  connectStr`),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"useNewUrlParser"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"useUnifiedTopology"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" console"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'MongoDB 连接成功'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},")"),s(`
mongoose`),n("span",{class:"token punctuation"},"."),s("connection"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"on"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'error'"),n("span",{class:"token punctuation"},","),s(" console"),n("span",{class:"token punctuation"},"."),s("error"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),O=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 用户模型"),s(`
`),n("span",{class:"token keyword"},"const"),s(" mongoose "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'mongoose'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" Schema"),n("span",{class:"token punctuation"},","),s(" model "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` mongoose
`),n("span",{class:"token keyword"},"const"),s(" userShechma "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Schema"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token literal-property property"},"password"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"model"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'User'"),n("span",{class:"token punctuation"},","),s(" userShechma"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),z=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" User "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../models/users'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" secret "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../config'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 用户控制器"),s(`
`),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"UsersCtl"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// 获取用户列表"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// 模拟抛出 500 错误"),s(`
    `),n("span",{class:"token comment"},"// a.b"),s(`
    `),n("span",{class:"token comment"},"// ctx.throw(412, '先决条件失败')"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 获取用户详情"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" user "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("user"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"404"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'用户不存在'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` user
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 创建用户"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"create"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// 参数校验"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"verifyParams"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"password"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'ctx.request.body'"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s("body"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// 重复用户名校验"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" name "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s(`body
    `),n("span",{class:"token keyword"},"const"),s(" repeatedUser "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findOne"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" name "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("repeatedUser"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"409"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'用户已存在'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" user "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"User"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s("body"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` user
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 修改用户"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"update"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// 参数校验"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"verifyParams"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"password"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" user "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findByIdAndUpdate"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s("body"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("user"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"404"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'用户不存在'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` user
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 删除用户"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"del"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" user "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findByIdAndRemove"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("user"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"404"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'用户不存在'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"UsersCtl"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),M=n("h2",{id:"jwt-在-koa-中使用",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#jwt-在-koa-中使用","aria-hidden":"true"},"#"),s(" jwt 在 koa 中使用")],-1),N=n("ul",null,[n("li",null,[n("code",null,"jsonwebtoken"),s(" 生成 token, 认证 token")]),n("li",null,[n("code",null,"koa-jwt"),s(" 中间件 来作为 koa 验证 token 中间件")])],-1),W=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[s(`
`),n("span",{class:"token comment"},"// 登录"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"login"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// 参数校验"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"verifyParams"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"password"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// 是否有该用户"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" user "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findOne"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s("body"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("user"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"401"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'用户名或密码不正确'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token comment"},"// 生成 token"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" _id"),n("span",{class:"token punctuation"},","),s(" name "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` user
    `),n("span",{class:"token keyword"},"const"),s(" token "),n("span",{class:"token operator"},"="),s(" jsonwebtoken"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"sign"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" _id"),n("span",{class:"token punctuation"},","),s(" name "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(" secret"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"expiresIn"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'1d'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(" token "),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

   `),n("span",{class:"token comment"},"// 检查用户是否是自己(是本人才能修改数据和删除数据)"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"checkOwner"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id "),n("span",{class:"token operator"},"!=="),s(" ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"403"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'没有权限'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),G=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" Router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-router'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// const jsonwebtoken = require('jsonwebtoken')"),s(`
`),n("span",{class:"token keyword"},"const"),s(" koajwt "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-jwt'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" secret "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../config'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Router"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"prefix"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'/users'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(`
  find`),n("span",{class:"token punctuation"},","),s(`
  findById`),n("span",{class:"token punctuation"},","),s(`
  create`),n("span",{class:"token punctuation"},","),s(`
  update`),n("span",{class:"token punctuation"},","),s(`
  del`),n("span",{class:"token punctuation"},","),s(`
  login`),n("span",{class:"token punctuation"},","),s(`
  checkOwner`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../controllers/users'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 模拟用户验证鉴权中间件"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"auth"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("url "),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token string"},"'/users'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"401"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// const authToken = async (ctx, next) => {"),s(`
`),n("span",{class:"token comment"},"//   const { authorization = '' } = ctx.request.header"),s(`
`),n("span",{class:"token comment"},"//   const token = authorization.replace('Bearer ', '')"),s(`
`),n("span",{class:"token comment"},"//   try {"),s(`
`),n("span",{class:"token comment"},"//     const user = jsonwebtoken.verify(token, secret)"),s(`
`),n("span",{class:"token comment"},"//     ctx.state.user = user"),s(`
`),n("span",{class:"token comment"},"//   } catch (err) {"),s(`
`),n("span",{class:"token comment"},"//     ctx.throw(401, err.message)"),s(`
`),n("span",{class:"token comment"},"//   }"),s(`
`),n("span",{class:"token comment"},"//   await next()"),s(`
`),n("span",{class:"token comment"},"// }"),s(`
`),n("span",{class:"token comment"},"// koa-jwt 替换上面自定义的 authToken 中间件"),s(`
`),n("span",{class:"token keyword"},"const"),s(" authToken "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"koajwt"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" secret "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 用户列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" find"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 创建用户"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"post"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" create"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 用户详情"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" authToken"),n("span",{class:"token punctuation"},","),s(" findById"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 修改用户"),s(`
`),n("span",{class:"token comment"},"// 全量修改使用 put"),s(`
`),n("span",{class:"token comment"},"// router.put('/:id', update)"),s(`
`),n("span",{class:"token comment"},"// 部分修改使用 patch"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"patch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" authToken"),n("span",{class:"token punctuation"},","),s(" checkOwner"),n("span",{class:"token punctuation"},","),s(" update"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 删除用户"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"delete"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" authToken"),n("span",{class:"token punctuation"},","),s(" checkOwner"),n("span",{class:"token punctuation"},","),s(" del"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 登录"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"post"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/login'"),n("span",{class:"token punctuation"},","),s(" login"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(` router
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),D=n("h2",{id:"使用-vscode-插件-rest-client",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#使用-vscode-插件-rest-client","aria-hidden":"true"},"#"),s(" 使用 vscode 插件 "),n("code",null,"REST Client")],-1),Y=n("ul",null,[n("li",null,"测试接口，替换 postman 测试")],-1),Q=n("div",{class:"language-http line-numbers-mode","data-ext":"http"},[n("pre",{class:"language-http"},[n("code",null,[s(`### 变量

@token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MzdhZjY3NDE2NWRjZDAxMzJkYTkxMjYiLCJuYW1lIjoidGVzdCIsImlhdCI6MTY2OTAwOTg3NCwiZXhwIjoxNjY5MDk2Mjc0fQ.o6VSajZt3eIncTVnsbZDif-zONLAlRdTHVaR3MxoAik


### 请求用户列表
`),n("span",{class:"token request-line"},[n("span",{class:"token method property"},"GET"),s(),n("span",{class:"token request-target url"},"http://localhost:3000/users/"),s(),n("span",{class:"token http-version property"},"HTTP/1.1")]),s(`

### 用户详情
`),n("span",{class:"token request-line"},[n("span",{class:"token method property"},"GET"),s(),n("span",{class:"token request-target url"},"http://localhost:3000/users/637af674165dcd0132da9126"),s(),n("span",{class:"token http-version property"},"HTTP/1.1")]),s(`
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Authorization"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"Bearer {{token}}")]),s(`
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Content-Type"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"application/json")]),s(`
`),n("span",{class:"token application-json"},`


### 新增用户
`),n("span",{class:"token request-line"},[n("span",{class:"token method property"},"POST"),s(),n("span",{class:"token request-target url"},"http://localhost:3000/users"),s(),n("span",{class:"token http-version property"},"HTTP/1.1")]),s(`
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Content-Type"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"application/json")]),s(`
`),n("span",{class:"token application-json"},[s(`
`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

### 修改用户
`)]),n("span",{class:"token request-line"},[n("span",{class:"token method property"},"PATCH"),s(),n("span",{class:"token request-target url"},"http://localhost:3000/users/637af674165dcd0132da9126"),s(),n("span",{class:"token http-version property"},"HTTP/1.1")]),s(`
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Authorization"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"Bearer {{token}}")]),s(`
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Content-Type"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"application/json")]),s(`
`),n("span",{class:"token application-json"},[s(`
`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test100"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

### 删除用户
`)]),n("span",{class:"token request-line"},[n("span",{class:"token method property"},"DELETE"),s(),n("span",{class:"token request-target url"},"http://localhost:3000/users/637af42c7c3fd94d5c7916ba"),s(),n("span",{class:"token http-version property"},"HTTP/1.1")]),s(`


### 用户登录
`),n("span",{class:"token request-line"},[n("span",{class:"token method property"},"POST"),s(),n("span",{class:"token request-target url"},"http://localhost:3000/users/login"),s(),n("span",{class:"token http-version property"},"HTTP/1.1")]),s(`
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Content-Type"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"application/json")]),s(`
`),n("span",{class:"token application-json"},[s(`
`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),F=n("h2",{id:"上传图片",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#上传图片","aria-hidden":"true"},"#"),s(" 上传图片")],-1),J=n("ul",null,[n("li",null,[s("使用 "),n("code",null,"koa-body@4.1.0"),s(" 版本")]),n("li",null,[s("新建存放图片目录"),n("code",null,"/public/uploads")])],-1),V=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[s(`
`),n("span",{class:"token comment"},"// koa-body 解析请求体 multipart/form-data 上传文件"),s(`
`),n("span",{class:"token keyword"},"const"),s(" koaBody "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-body'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"//最新版本"),s(`
`),n("span",{class:"token comment"},"// const { koaBody } = require('koa-body')"),s(`
`),n("span",{class:"token operator"},"..."),n("span",{class:"token punctuation"},"."),s(`
app`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"use"),n("span",{class:"token punctuation"},"("),s(`
  `),n("span",{class:"token function"},"koaBody"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"multipart"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"formidable"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"maxFileSize"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"200"),s(),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token number"},"1024"),s(),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token number"},"1024"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"uploadDir"),n("span",{class:"token operator"},":"),s(" path"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"join"),n("span",{class:"token punctuation"},"("),s("__dirname"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'/public/uploads'"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"keepExtensions"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Z=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 上传"),s(`
 `),n("span",{class:"token function"},"upload"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" file "),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s("files"),n("span",{class:"token punctuation"},"."),s(`file
    `),n("span",{class:"token keyword"},"const"),s(" basename "),n("span",{class:"token operator"},"="),s(" path"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"basename"),n("span",{class:"token punctuation"},"("),s("file"),n("span",{class:"token punctuation"},"."),s("path"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"url"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("ctx"),n("span",{class:"token punctuation"},"."),s("origin"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},"/uploads/"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("basename"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),s(),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),K=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" index"),n("span",{class:"token punctuation"},","),s(" upload "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../controllers/home'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token operator"},"..."),s(`
`),n("span",{class:"token comment"},"// 上传文件"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"post"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/upload'"),n("span",{class:"token punctuation"},","),s(" upload"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),X=n("div",{class:"language-http line-numbers-mode","data-ext":"http"},[n("pre",{class:"language-http"},[n("code",null,[s(`### 变量
@token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MzdhZjY3NDE2NWRjZDAxMzJkYTkxMjYiLCJuYW1lIjoidGVzdCIsImlhdCI6MTY2OTAwOTg3NCwiZXhwIjoxNjY5MDk2Mjc0fQ.o6VSajZt3eIncTVnsbZDif-zONLAlRdTHVaR3MxoAik

@BASE_URL = http://localhost:3000/

### 请求用户列表
GET {{BASE_URL}}users/ HTTP/1.1

### 用户详情
GET {{BASE_URL}}users/637af674165dcd0132da9126 HTTP/1.1
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Authorization"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"Bearer {{token}}")]),s(`
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Content-Type"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"application/json")]),s(`
`),n("span",{class:"token application-json"},[s(`


### 新增用户
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

### 修改用户
PATCH `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637af674165dcd0132da9126 HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test100"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

### 删除用户
DELETE `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637af42c7c3fd94d5c7916ba HTTP/"),n("span",{class:"token number"},"1.1"),s(`


### 用户登录
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/login HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

### 文件上传
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("upload HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition`),n("span",{class:"token operator"},":"),s(" form-data; name="),n("span",{class:"token string"},'"file"'),s("; filename="),n("span",{class:"token string"},'"1.jpg"'),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` image/jpeg

< ./`),n("span",{class:"token number"},"1"),s(`.jpg
------WebKitFormBoundary7MA4YWxkTrZu0gW--
`)])])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),$=n("h2",{id:"个人资料完善",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#个人资料完善","aria-hidden":"true"},"#"),s(" 个人资料完善")],-1),nn=n("ul",null,[n("li",null,"完善用户信息")],-1),sn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 用户模型"),s(`
`),n("span",{class:"token keyword"},"const"),s(" mongoose "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'mongoose'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" Schema"),n("span",{class:"token punctuation"},","),s(" model "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` mongoose
`),n("span",{class:"token keyword"},"const"),s(" userShechma "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Schema"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token literal-property property"},"__v"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Number"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token literal-property property"},"password"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 头像"),s(`
  `),n("span",{class:"token literal-property property"},"avatar_url"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 性别"),s(`
  `),n("span",{class:"token literal-property property"},"gender"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token keyword"},"enum"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'male'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'female'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token keyword"},"default"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'male'"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 简介"),s(`
  `),n("span",{class:"token literal-property property"},"headline"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 位置"),s(`
  `),n("span",{class:"token literal-property property"},"locations"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 行业"),s(`
  `),n("span",{class:"token literal-property property"},"business"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 职业经历"),s(`
  `),n("span",{class:"token literal-property property"},"employments"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"company"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"job"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 教育经历"),s(`
  `),n("span",{class:"token literal-property property"},"educations"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),s(`
      `),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token literal-property property"},"school"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token literal-property property"},"major"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token literal-property property"},"diploma"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Number"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"enum"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"2"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"3"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"4"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"5"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token comment"},"// 入学时间"),s(`
        `),n("span",{class:"token literal-property property"},"entrance_year"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Number "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token comment"},"// 毕业时间"),s(`
        `),n("span",{class:"token literal-property property"},"graduation_year"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Number "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"model"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'User'"),n("span",{class:"token punctuation"},","),s(" userShechma"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),an=n("div",{class:"language-http line-numbers-mode","data-ext":"http"},[n("pre",{class:"language-http"},[n("code",null,[s(`### 变量
@token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MzdhZjY3NDE2NWRjZDAxMzJkYTkxMjYiLCJuYW1lIjoidGVzdCIsImlhdCI6MTY2OTAwOTg3NCwiZXhwIjoxNjY5MDk2Mjc0fQ.o6VSajZt3eIncTVnsbZDif-zONLAlRdTHVaR3MxoAik

@BASE_URL = http://localhost:3000/

### 请求用户列表
GET {{BASE_URL}}users/ HTTP/1.1

### 用户详情
GET {{BASE_URL}}users/637af674165dcd0132da9126?fields=business;locations HTTP/1.1
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Authorization"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"Bearer {{token}}")]),s(`
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Content-Type"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"application/json")]),s(`
`),n("span",{class:"token application-json"},[s(`


### 新增用户
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

### 修改用户
PATCH `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637af674165dcd0132da9126 HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test100"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"avatar_url"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"https://www.baidu.com/img/bd_logo1.png"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"gender"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"male"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"headline"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"locations"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"北京"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"上海"'),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"business"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"IT"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"employments"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),s(`
        `),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token property"},'"company"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"阿里巴巴"'),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"job"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"前端专家"'),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"educations"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),s(`
        `),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token property"},'"school"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"清华大学"'),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"major"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"计算机科学与技术"'),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"diploma"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"3"),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"entrance_year"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"2010"),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"graduation_year"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"2014"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"]"),s(`

`),n("span",{class:"token punctuation"},"}"),s(`

### 删除用户
DELETE `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637af42c7c3fd94d5c7916ba HTTP/"),n("span",{class:"token number"},"1.1"),s(`


### 用户登录
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/login HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

### 文件上传
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("upload HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition`),n("span",{class:"token operator"},":"),s(" form-data; name="),n("span",{class:"token string"},'"file"'),s("; filename="),n("span",{class:"token string"},'"1.jpg"'),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` image/jpeg

< ./`),n("span",{class:"token number"},"1"),s(`.jpg
------WebKitFormBoundary7MA4YWxkTrZu0gW--
`)])])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),tn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[s(),n("span",{class:"token comment"},"// 获取用户详情"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// 用户要显示的字段"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" fields "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s(`query
    `),n("span",{class:"token keyword"},"const"),s(" selectFields "),n("span",{class:"token operator"},"="),s(` fields
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"split"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"';'"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"filter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"f"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" f"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"f"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token string"},"' +'"),s(),n("span",{class:"token operator"},"+"),s(" f"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"join"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" user "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),s("selectFields"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("user"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"404"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'用户不存在'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` user
  `),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),en=n("h2",{id:"关注与粉丝模块",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#关注与粉丝模块","aria-hidden":"true"},"#"),s(" 关注与粉丝模块")],-1),on=n("ul",null,[n("li",null,"用户与粉丝的关系，多对多的关系"),n("li",null,[s("修改用户 "),n("code",null,"model")]),n("li",null,"关注与取消关注时候，需要校验用户是否存在")],-1),cn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[s(),n("span",{class:"token comment"},"// 关注者"),s(`
  `),n("span",{class:"token literal-property property"},"following"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'User'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),pn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 获取关注列表"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"listFollowing"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" user "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'+following'"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"populate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'following'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("user"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"404"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(" user"),n("span",{class:"token punctuation"},"."),s(`following
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 关注用户"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"follow"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" me "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'+following'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// 判断是否已经关注"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("me"),n("span",{class:"token punctuation"},"."),s("following"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"id"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" id"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"includes"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      me`),n("span",{class:"token punctuation"},"."),s("following"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
      me`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token comment"},"// 校验用户是否存在 中间件"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"checkUserExist"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" user "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("user"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"404"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'用户不存在'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 取消关注"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"unfollow"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" me "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'+following'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// 判断是否已经关注"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" index "),n("span",{class:"token operator"},"="),s(" me"),n("span",{class:"token punctuation"},"."),s("following"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"id"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" id"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"indexOf"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("index "),n("span",{class:"token operator"},">"),s(),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      me`),n("span",{class:"token punctuation"},"."),s("following"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"splice"),n("span",{class:"token punctuation"},"("),s("index"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(`
      me`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 获取粉丝列表"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"listFollowers"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" users "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"following"),n("span",{class:"token operator"},":"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` users
  `),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),ln=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(`
  find`),n("span",{class:"token punctuation"},","),s(`
  findById`),n("span",{class:"token punctuation"},","),s(`
  create`),n("span",{class:"token punctuation"},","),s(`
  update`),n("span",{class:"token punctuation"},","),s(`
  del`),n("span",{class:"token punctuation"},","),s(`
  login`),n("span",{class:"token punctuation"},","),s(`
  checkOwner`),n("span",{class:"token punctuation"},","),s(`
  listFollowing`),n("span",{class:"token punctuation"},","),s(`
  listFollowers`),n("span",{class:"token punctuation"},","),s(`
  checkUserExist`),n("span",{class:"token punctuation"},","),s(`
  follow`),n("span",{class:"token punctuation"},","),s(`
  unfollow`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../controllers/users'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token operator"},"..."),s(`


`),n("span",{class:"token comment"},"// 获取关注列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id/following'"),n("span",{class:"token punctuation"},","),s(" listFollowing"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 关注某人"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"put"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/following/:id'"),n("span",{class:"token punctuation"},","),s(" authToken"),n("span",{class:"token punctuation"},","),s(" checkUserExist"),n("span",{class:"token punctuation"},","),s(" follow"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 取消关注某人"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"delete"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/following/:id'"),n("span",{class:"token punctuation"},","),s(" authToken"),n("span",{class:"token punctuation"},","),s(" checkUserExist"),n("span",{class:"token punctuation"},","),s(" unfollow"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 获取粉丝列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id/followers'"),n("span",{class:"token punctuation"},","),s(" listFollowers"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),un=n("div",{class:"language-http line-numbers-mode","data-ext":"http"},[n("pre",{class:"language-http"},[n("code",null,[s(`### 获取某个用户关注人列表
GET {{BASE_URL}}users/637af674165dcd0132da9126/following HTTP/1.1

### 关注某个用户
PUT {{BASE_URL}}users/following/637b9536e023f89d918ba8b8 HTTP/1.1
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Authorization"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"Bearer {{token}}")]),s(`

### 取消关注
DELETE {{BASE_URL}}users/following/637b9536e023f89d918ba8b8 HTTP/1.1
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Authorization"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"Bearer {{token}}")]),s(`

### 获取某个用户粉丝列表
GET {{BASE_URL}}users/637b9536e023f89d918ba8b8/followers HTTP/1.1
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),rn=n("h2",{id:"话题模块",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#话题模块","aria-hidden":"true"},"#"),s(" 话题模块")],-1),kn=n("ul",null,[n("li",null,"话题的增删改查"),n("li",null,"话题模糊搜索")],-1),dn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" mongoose "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'mongoose'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" Schema"),n("span",{class:"token punctuation"},","),s(" model "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` mongoose

`),n("span",{class:"token keyword"},"const"),s(" TopicSchema "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Schema"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token literal-property property"},"__v"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Number"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 话题名称"),s(`
  `),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 话题头像"),s(`
  `),n("span",{class:"token literal-property property"},"avatar_url"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 话题简介"),s(`
  `),n("span",{class:"token literal-property property"},"introduction"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"model"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'Topic'"),n("span",{class:"token punctuation"},","),s(" TopicSchema"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),mn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 话题控制器"),s(`
`),n("span",{class:"token keyword"},"const"),s(" Topic "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../models/topics'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"TopicCtl"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// 获取话题列表"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" per_page "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"10"),s(),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s(`query
    `),n("span",{class:"token keyword"},"const"),s(" page "),n("span",{class:"token operator"},"="),s(" Math"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"max"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("query"),n("span",{class:"token punctuation"},"."),s("page "),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token number"},"1"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" perPage "),n("span",{class:"token operator"},"="),s(" Math"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"max"),n("span",{class:"token punctuation"},"("),s("per_page "),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// 模糊查询 q=xxx"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Topic"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"RegExp"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("query"),n("span",{class:"token punctuation"},"."),s("q"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"limit"),n("span",{class:"token punctuation"},"("),s("perPage"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"skip"),n("span",{class:"token punctuation"},"("),s("page "),n("span",{class:"token operator"},"*"),s(" perPage"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 获取特定话题"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" fields "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"''"),s(),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s(`query
    `),n("span",{class:"token keyword"},"const"),s(" selectFields "),n("span",{class:"token operator"},"="),s(` fields
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"split"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"';'"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"filter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"f"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" f"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"f"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token string"},"' +'"),s(),n("span",{class:"token operator"},"+"),s(" f"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"join"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" topic "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Topic"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),s("selectFields"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` topic
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 创建话题"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"create"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"verifyParams"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"avatar_url"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"introduction"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" topic "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Topic"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s("body"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` topic
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 修改话题"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"update"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"verifyParams"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"avatar_url"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"introduction"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" topic "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Topic"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findByIdAndUpdate"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},","),s(" ctx"),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s("body"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` topic
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 删除话题"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"delete"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"await"),s(" Topic"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findByIdAndRemove"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"TopicCtl"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),bn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 话题路由"),s(`
`),n("span",{class:"token keyword"},"const"),s(" Router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-router'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Router"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"prefix"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'/topics'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(`
  find`),n("span",{class:"token punctuation"},","),s(`
  findById`),n("span",{class:"token punctuation"},","),s(`
  create`),n("span",{class:"token punctuation"},","),s(`
  update`),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token keyword"},"delete"),n("span",{class:"token operator"},":"),s(" del"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../controllers/topics'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 获取话题列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" find"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 获取特定话题"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" findById"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 创建话题"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"post"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" create"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 修改话题"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"patch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" update"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 删除话题"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"delete"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" del"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(` router
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),vn=n("div",{class:"language-http line-numbers-mode","data-ext":"http"},[n("pre",{class:"language-http"},[n("code",null,[s(`## 话题列表
GET {{BASE_URL}}topics?page=2&per_page=2&q=t HTTP/1.1

### 话题详情
GET {{BASE_URL}}topics/637ba02afdb8e477106fab5f HTTP/1.1

### 新增话题
POST {{BASE_URL}}topics HTTP/1.1
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Authorization"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"Bearer {{token}}")]),s(`
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Content-Type"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"application/json")]),s(`
`),n("span",{class:"token application-json"},[s(`
`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test3"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"avatar_url"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"https://www.baidu.com/img/bd_logo1.png"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"introduction"'),n("span",{class:"token operator"},":"),n("span",{class:"token string"},'"test3"'),s(`

`),n("span",{class:"token punctuation"},"}"),s(`

### 修改话题
PATCH `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`topics/637ba02afdb8e477106fab5f HTTP/
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test2"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"avatar_url"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"https://www.baidu.com/img/bd_logo1.png"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"introduction"'),n("span",{class:"token operator"},":"),n("span",{class:"token string"},'"test2"'),s(`

`),n("span",{class:"token punctuation"},"}"),s(`

### 删除话题
DELETE `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("topics/637ba02afdb8e477106fab5f HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
`)])])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),yn=n("ul",null,[n("li",null,"用户关注话题 ， 用户可以关注多个话题，话题也可以被多个用户关注")],-1),gn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 用户模型"),s(`
`),n("span",{class:"token keyword"},"const"),s(" mongoose "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'mongoose'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" Schema"),n("span",{class:"token punctuation"},","),s(" model "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` mongoose
`),n("span",{class:"token keyword"},"const"),s(" userShechma "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Schema"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token literal-property property"},"__v"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Number"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token literal-property property"},"name"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token literal-property property"},"password"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 头像"),s(`
  `),n("span",{class:"token literal-property property"},"avatar_url"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 性别"),s(`
  `),n("span",{class:"token literal-property property"},"gender"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token keyword"},"enum"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'male'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'female'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token keyword"},"default"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'male'"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 简介"),s(`
  `),n("span",{class:"token literal-property property"},"headline"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 位置"),s(`
  `),n("span",{class:"token literal-property property"},"locations"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Topic'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 行业"),s(`
  `),n("span",{class:"token literal-property property"},"business"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Topic'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 职业经历"),s(`
  `),n("span",{class:"token literal-property property"},"employments"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),s(`
      `),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token literal-property property"},"company"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Topic'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token literal-property property"},"job"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Topic'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 教育经历"),s(`
  `),n("span",{class:"token literal-property property"},"educations"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),s(`
      `),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// 学校"),s(`
        `),n("span",{class:"token literal-property property"},"school"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Topic'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token comment"},"// 专业"),s(`
        `),n("span",{class:"token literal-property property"},"major"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Topic'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token literal-property property"},"diploma"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Number"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"enum"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"2"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"3"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"4"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"5"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token comment"},"// 入学时间"),s(`
        `),n("span",{class:"token literal-property property"},"entrance_year"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Number "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token comment"},"// 毕业时间"),s(`
        `),n("span",{class:"token literal-property property"},"graduation_year"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Number "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 关注者"),s(`
  `),n("span",{class:"token literal-property property"},"following"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'User'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 关注的话题"),s(`
  `),n("span",{class:"token literal-property property"},"followingTopics"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Topic'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"model"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'User'"),n("span",{class:"token punctuation"},","),s(" userShechma"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),fn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 获取关注话题列表"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"listFollowingTopics"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" user "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'+followingTopics'"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"populate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'followingTopics'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("user"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"404"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(" user"),n("span",{class:"token punctuation"},"."),s(`followingTopics
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 关注话题"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"followTopic"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" me "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),s(`
      `),n("span",{class:"token string"},"'+followingTopics'"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// 判断是否已经关注"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s(`
      `),n("span",{class:"token operator"},"!"),s("me"),n("span",{class:"token punctuation"},"."),s("followingTopics"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"id"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" id"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"includes"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      me`),n("span",{class:"token punctuation"},"."),s("followingTopics"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
      me`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 取消关注话题"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"unfollowTopic"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" me "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),s(`
      `),n("span",{class:"token string"},"'+followingTopics'"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// 判断是否已经关注"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" index "),n("span",{class:"token operator"},"="),s(" me"),n("span",{class:"token punctuation"},"."),s(`followingTopics
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"id"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" id"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"indexOf"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("index "),n("span",{class:"token operator"},">"),s(),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      me`),n("span",{class:"token punctuation"},"."),s("followingTopics"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"splice"),n("span",{class:"token punctuation"},"("),s("index"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(`
      me`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),wn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(`
  find`),n("span",{class:"token punctuation"},","),s(`
  findById`),n("span",{class:"token punctuation"},","),s(`
  create`),n("span",{class:"token punctuation"},","),s(`
  update`),n("span",{class:"token punctuation"},","),s(`
  del`),n("span",{class:"token punctuation"},","),s(`
  login`),n("span",{class:"token punctuation"},","),s(`
  checkOwner`),n("span",{class:"token punctuation"},","),s(`
  listFollowing`),n("span",{class:"token punctuation"},","),s(`
  listFollowers`),n("span",{class:"token punctuation"},","),s(`
  checkUserExist`),n("span",{class:"token punctuation"},","),s(`
  follow`),n("span",{class:"token punctuation"},","),s(`
  unfollow`),n("span",{class:"token punctuation"},","),s(`
  followTopic`),n("span",{class:"token punctuation"},","),s(`
  unfollowTopic`),n("span",{class:"token punctuation"},","),s(`
  listFollowingTopics`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../controllers/users'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" checkTopicExist "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../controllers/topics'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token operator"},"..."),s(`
`),n("span",{class:"token comment"},"// 关注话题"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"put"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/followingTopics/:id'"),n("span",{class:"token punctuation"},","),s(" authToken"),n("span",{class:"token punctuation"},","),s(" checkTopicExist"),n("span",{class:"token punctuation"},","),s(" followTopic"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 取消关注话题"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"delete"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/followingTopics/:id'"),n("span",{class:"token punctuation"},","),s(" authToken"),n("span",{class:"token punctuation"},","),s(" checkTopicExist"),n("span",{class:"token punctuation"},","),s(" unfollowTopic"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 获取关注的话题列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id/followingTopics'"),n("span",{class:"token punctuation"},","),s(" listFollowingTopics"),n("span",{class:"token punctuation"},")"),s(`

`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),hn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 关注话题是否存在 中间件"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"checkTopicExist"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" topic "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Topic"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("topic"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"404"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'话题不存在'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 获取话题的关注者"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"listTopicFollowers"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" users "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"followingTopics"),n("span",{class:"token operator"},":"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` users
  `),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),xn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 话题路由"),s(`
`),n("span",{class:"token keyword"},"const"),s(" Router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-router'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" koajwt "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-jwt'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Router"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"prefix"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'/topics'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(`
  find`),n("span",{class:"token punctuation"},","),s(`
  findById`),n("span",{class:"token punctuation"},","),s(`
  create`),n("span",{class:"token punctuation"},","),s(`
  update`),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token keyword"},"delete"),n("span",{class:"token operator"},":"),s(" del"),n("span",{class:"token punctuation"},","),s(`
  checkTopicExist`),n("span",{class:"token punctuation"},","),s(`
  listTopicFollowers`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../controllers/topics'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" secret "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../config'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(" auth "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"koajwt"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" secret "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 获取话题列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" find"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 获取特定话题"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" checkTopicExist"),n("span",{class:"token punctuation"},","),s(" findById"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 创建话题"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"post"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(" create"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 修改话题"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"patch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(" checkTopicExist"),n("span",{class:"token punctuation"},","),s(" update"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 删除话题"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"delete"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" del"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 获取话题的粉丝列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id/followers'"),n("span",{class:"token punctuation"},","),s(" checkTopicExist"),n("span",{class:"token punctuation"},","),s(" listTopicFollowers"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(` router
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),_n=n("div",{class:"language-http line-numbers-mode","data-ext":"http"},[n("pre",{class:"language-http"},[n("code",null,[s(`
### 变量
@token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MzdiOTUzNmUwMjNmODlkOTE4YmE4YjgiLCJuYW1lIjoidGVzdDIiLCJpYXQiOjE2NjkwNDQ2MjIsImV4cCI6MTY2OTEzMTAyMn0.ZPLYEUEcriiWTGxT7HHPOUHLy1g-hSHLI8LN_4c6QVc

@BASE_URL = http://localhost:3000/

### 请求用户列表
GET {{BASE_URL}}users/ HTTP/1.1

### 用户详情
GET {{BASE_URL}}users/637af674165dcd0132da9126?fields=business;locations;educations;employments; HTTP/1.1
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Authorization"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"Bearer {{token}}")]),s(`
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Content-Type"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"application/json")]),s(`
`),n("span",{class:"token application-json"},[s(`


### 新增用户
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test2"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

### 修改用户
PATCH `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637af674165dcd0132da9126 HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test100"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"avatar_url"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"https://www.baidu.com/img/bd_logo1.png"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"gender"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"male"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"headline"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"locations"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"北京"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"上海"'),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"business"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"IT"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"employments"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),s(`
        `),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token property"},'"company"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"阿里巴巴"'),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"job"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"前端专家"'),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"educations"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),s(`
        `),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token property"},'"school"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"清华大学"'),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"major"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"计算机科学与技术"'),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"diploma"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"3"),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"entrance_year"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"2010"),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"graduation_year"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"2014"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"]"),s(`

`),n("span",{class:"token punctuation"},"}"),s(`

### 删除用户
DELETE `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637af42c7c3fd94d5c7916ba HTTP/"),n("span",{class:"token number"},"1.1"),s(`


### 用户登录
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/login HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test2"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

### 文件上传
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("upload HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition`),n("span",{class:"token operator"},":"),s(" form-data; name="),n("span",{class:"token string"},'"file"'),s("; filename="),n("span",{class:"token string"},'"1.jpg"'),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` image/jpeg

< ./`),n("span",{class:"token number"},"1"),s(`.jpg
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### 获取用户关注人列表
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637af674165dcd0132da9126/following HTTP/"),n("span",{class:"token number"},"1.1"),s(`

### 关注用户
PUT `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/following/637b9536e023f89d918ba8b8 HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`

### 取消关注
DELETE `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/following/637b9536e023f89d918ba8b8 HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`

### 获取用户粉丝列表
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637b9536e023f89d918ba8b8/followers HTTP/"),n("span",{class:"token number"},"1.1"),s(`

### 获取用户关注话题列表
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637b9536e023f89d918ba8b8/followingTopics HTTP/"),n("span",{class:"token number"},"1.1"),s(`

### 关注某个话题
PUT `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`users/followingTopics/637c235dd0f3a38dd1b9783a
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`

### 取消关注某个话题
DELETE `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`users/followingTopics/637c235dd0f3a38dd1b9783a
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`


### 话题列表
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("topics?page="),n("span",{class:"token number"},"1"),s("&per_page="),n("span",{class:"token number"},"20"),s("&q= HTTP/"),n("span",{class:"token number"},"1.1"),s(`

### 话题详情
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("topics/637c1fec3d25426a6c8c10e9 HTTP/"),n("span",{class:"token number"},"1.1"),s(`

### 新增话题
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("topics HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"新的话题"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"avatar_url"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"https://www.baidu.com/img/bd_logo1.png"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"introduction"'),n("span",{class:"token operator"},":"),n("span",{class:"token string"},'"新的话题"'),s(`

`),n("span",{class:"token punctuation"},"}"),s(`

### 修改话题
PATCH `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`topics/637ba02afdb8e477106fab5f HTTP/
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test2"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"avatar_url"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"https://www.baidu.com/img/bd_logo1.png"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"introduction"'),n("span",{class:"token operator"},":"),n("span",{class:"token string"},'"test2"'),s(`

`),n("span",{class:"token punctuation"},"}"),s(`

### 删除话题
DELETE `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("topics/637ba02afdb8e477106fab5f HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`

### 获取话题的粉丝列表
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("topics/637c235dd0f3a38dd1b9783a/followers HTTP/"),n("span",{class:"token number"},"1.1"),s(`
`)])])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Tn=n("h2",{id:"问题模块",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#问题模块","aria-hidden":"true"},"#"),s(" 问题模块")],-1),jn=n("ul",null,[n("li",null,"问题列表（用户-问题一对多关系）"),n("li",null,"话题列表（问题-话题多对多关系）"),n("li",null,"用户关注问题（略）")],-1),An=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[s(),n("span",{class:"token comment"},"// 关注的问题"),s(`
  `),n("span",{class:"token literal-property property"},"followingQuestions"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Question'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),qn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 问题模型"),s(`
`),n("span",{class:"token keyword"},"const"),s(" mongoose "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'mongoose'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" Schema"),n("span",{class:"token punctuation"},","),s(" model "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` mongoose

`),n("span",{class:"token keyword"},"const"),s(" QuestionSchema "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Schema"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token literal-property property"},"__v"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Number"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 问题标题"),s(`
  `),n("span",{class:"token literal-property property"},"title"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 问题描述"),s(`
  `),n("span",{class:"token literal-property property"},"description"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 问题关联的话题"),s(`
  `),n("span",{class:"token literal-property property"},"topics"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Topic'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 问题的创建者"),s(`
  `),n("span",{class:"token literal-property property"},"questioner"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'User'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"model"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'Question'"),n("span",{class:"token punctuation"},","),s(" QuestionSchema"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),En=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" Question "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../models/questions'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 问题控制器"),s(`
`),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"QuestionsCtl"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// 查询所有问题"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" per_page "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"10"),s(),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s(`query
    `),n("span",{class:"token keyword"},"const"),s(" page "),n("span",{class:"token operator"},"="),s(" Math"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"max"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("query"),n("span",{class:"token punctuation"},"."),s("page "),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token number"},"1"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" perPage "),n("span",{class:"token operator"},"="),s(" Math"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"max"),n("span",{class:"token punctuation"},"("),s("per_page "),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Question"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"title"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"RegExp"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("query"),n("span",{class:"token punctuation"},"."),s("q"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"limit"),n("span",{class:"token punctuation"},"("),s("perPage"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"skip"),n("span",{class:"token punctuation"},"("),s("page "),n("span",{class:"token operator"},"*"),s(" perPage"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 根据id查询问题"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" question "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Question"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"populate"),n("span",{class:"token punctuation"},"("),s(`
      `),n("span",{class:"token string"},"'questioner topics'"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` question
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 创建问题"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"create"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"verifyParams"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"title"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"topics"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'array'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"itemType"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"description"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" question "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Question"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token operator"},"..."),s("ctx"),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s("body"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"questioner"),n("span",{class:"token operator"},":"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` question
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 修改问题"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"update"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"verifyParams"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"title"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"topics"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'array'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"itemType"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"description"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"const"),s(" question "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Question"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findByIdAndUpdate"),n("span",{class:"token punctuation"},"("),s(`
      ctx`),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},","),s(`
      ctx`),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s(`body
    `),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` question
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 删除问题"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"delete"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" question "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Question"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findByIdAndRemove"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 检查问题是否存在"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"checkQuestionExist"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" question "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Question"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),s(`
      `),n("span",{class:"token string"},"'+questioner'"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("question"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"404"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'问题不存在'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"QuestionsCtl"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Sn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 问题路由"),s(`
`),n("span",{class:"token comment"},"// 话题路由"),s(`
`),n("span",{class:"token keyword"},"const"),s(" Router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-router'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" koajwt "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-jwt'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Router"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"prefix"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'/questions'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(`
  find`),n("span",{class:"token punctuation"},","),s(`
  findById`),n("span",{class:"token punctuation"},","),s(`
  create`),n("span",{class:"token punctuation"},","),s(`
  update`),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token keyword"},"delete"),n("span",{class:"token operator"},":"),s(" del"),n("span",{class:"token punctuation"},","),s(`
  checkQuestionExist`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../controllers/questions'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" secret "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../config'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(" auth "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"koajwt"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" secret "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 获取问题列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" find"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 获取特定问题"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" findById"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 创建问题"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"post"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(" create"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 修改问题"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"patch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(" checkQuestionExist"),n("span",{class:"token punctuation"},","),s(" update"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 删除问题"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"delete"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(" checkQuestionExist"),n("span",{class:"token punctuation"},","),s(" del"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(` router
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Bn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[s(),n("span",{class:"token comment"},"// 话题下面的问题列表"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"listQuestions"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" questions "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Question"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"topics"),n("span",{class:"token operator"},":"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` questions
  `),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),In=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 获取话题的问题列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id/questions'"),n("span",{class:"token punctuation"},","),s(" checkTopicExist"),n("span",{class:"token punctuation"},","),s(" listQuestions"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Un=n("div",{class:"language-http line-numbers-mode","data-ext":"http"},[n("pre",{class:"language-http"},[n("code",null,[s(`### 变量
@token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MzdiOTUzNmUwMjNmODlkOTE4YmE4YjgiLCJuYW1lIjoidGVzdDIiLCJpYXQiOjE2NjkwNDQ2MjIsImV4cCI6MTY2OTEzMTAyMn0.ZPLYEUEcriiWTGxT7HHPOUHLy1g-hSHLI8LN_4c6QVc

@BASE_URL = http://localhost:3000/

### 请求用户列表
GET {{BASE_URL}}users/ HTTP/1.1

### 用户详情
GET {{BASE_URL}}users/637af674165dcd0132da9126?fields=business;locations;educations;employments;followingQuestions; HTTP/1.1
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Authorization"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"Bearer {{token}}")]),s(`
`),n("span",{class:"token header"},[n("span",{class:"token header-name keyword"},"Content-Type"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token header-value"},"application/json")]),s(`
`),n("span",{class:"token application-json"},[s(`


### 新增用户
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test2"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

### 修改用户
PATCH `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637af674165dcd0132da9126 HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test100"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"avatar_url"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"https://www.baidu.com/img/bd_logo1.png"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"gender"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"male"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"headline"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"locations"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"北京"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"上海"'),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"business"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"IT"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"employments"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),s(`
        `),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token property"},'"company"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"阿里巴巴"'),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"job"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"前端专家"'),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"educations"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),s(`
        `),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token property"},'"school"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"清华大学"'),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"major"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"计算机科学与技术"'),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"diploma"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"3"),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"entrance_year"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"2010"),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token property"},'"graduation_year"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"2014"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"]"),s(`

`),n("span",{class:"token punctuation"},"}"),s(`

### 删除用户
DELETE `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637af42c7c3fd94d5c7916ba HTTP/"),n("span",{class:"token number"},"1.1"),s(`


### 用户登录
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/login HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test2"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"password"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"123456"'),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

### 文件上传
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("upload HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition`),n("span",{class:"token operator"},":"),s(" form-data; name="),n("span",{class:"token string"},'"file"'),s("; filename="),n("span",{class:"token string"},'"1.jpg"'),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` image/jpeg

< ./`),n("span",{class:"token number"},"1"),s(`.jpg
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### 获取用户关注人列表
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637af674165dcd0132da9126/following HTTP/"),n("span",{class:"token number"},"1.1"),s(`

### 关注用户
PUT `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/following/637b9536e023f89d918ba8b8 HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`

### 取消关注
DELETE `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/following/637b9536e023f89d918ba8b8 HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`

### 获取用户粉丝列表
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637b9536e023f89d918ba8b8/followers HTTP/"),n("span",{class:"token number"},"1.1"),s(`

### 获取用户关注话题列表
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637b9536e023f89d918ba8b8/followingTopics HTTP/"),n("span",{class:"token number"},"1.1"),s(`

### 关注某个话题
PUT `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`users/followingTopics/637c235dd0f3a38dd1b9783a
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`

### 取消关注某个话题
DELETE `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`users/followingTopics/637c235dd0f3a38dd1b9783a
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`


### 话题列表
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("topics?page="),n("span",{class:"token number"},"1"),s("&per_page="),n("span",{class:"token number"},"20"),s("&q= HTTP/"),n("span",{class:"token number"},"1.1"),s(`

### 话题详情
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("topics/637c1fec3d25426a6c8c10e9 HTTP/"),n("span",{class:"token number"},"1.1"),s(`

### 新增话题
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("topics HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"新的话题"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"avatar_url"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"https://www.baidu.com/img/bd_logo1.png"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"introduction"'),n("span",{class:"token operator"},":"),n("span",{class:"token string"},'"新的话题"'),s(`

`),n("span",{class:"token punctuation"},"}"),s(`

### 修改话题
PATCH `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`topics/637ba02afdb8e477106fab5f HTTP/
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"name"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"test2"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"avatar_url"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"https://www.baidu.com/img/bd_logo1.png"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"introduction"'),n("span",{class:"token operator"},":"),n("span",{class:"token string"},'"test2"'),s(`

`),n("span",{class:"token punctuation"},"}"),s(`

### 删除话题
DELETE `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("topics/637ba02afdb8e477106fab5f HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`

### 获取话题的粉丝列表
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("topics/637c235dd0f3a38dd1b9783a/followers HTTP/"),n("span",{class:"token number"},"1.1"),s(`

### 获取话题的问题列表
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("topics/637c235dd0f3a38dd1b9783a/questions HTTP/"),n("span",{class:"token number"},"1.1"),s(`

### 用户问题列表
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("users/637b9536e023f89d918ba8b8/questions?page="),n("span",{class:"token number"},"1"),s("&per_page="),n("span",{class:"token number"},"20"),s("&q= HTTP/"),n("span",{class:"token number"},"1.1"),s(`


### 问题列表
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("questions?page="),n("span",{class:"token number"},"1"),s("&per_page="),n("span",{class:"token number"},"20"),s("&q= HTTP/"),n("span",{class:"token number"},"1.1"),s(`


### 问题详情
GET `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("questions/637c42c9b517d4d4c692d44e HTTP/"),n("span",{class:"token number"},"1.1"),s(`

### 新增问题
POST `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("questions HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"title"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"我的问题1"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"description"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"我的问题1"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"topics"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"637c1e9d3d25426a6c8c10d5"'),n("span",{class:"token punctuation"},"]"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

### 修改问题
PATCH `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s("questions/637c42c9b517d4d4c692d44e HTTP/"),n("span",{class:"token number"},"1.1"),s(`
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
Content-Type`),n("span",{class:"token operator"},":"),s(` application/json

`),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"title"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"我修改问题"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"description"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"我修改问题"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"topics"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"637c1fb63d25426a6c8c10e4"'),n("span",{class:"token punctuation"},"]"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`


### 删除问题
DELETE `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("BASE_URL"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`questions/637c1f9b3d25426a6c8c10e8 HTTP
Authorization`),n("span",{class:"token operator"},":"),s(" Bearer "),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s("token"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`

`)])])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Pn=n("h2",{id:"答案模块",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#答案模块","aria-hidden":"true"},"#"),s(" 答案模块")],-1),Rn=n("ul",null,[n("li",null,"答案列表"),n("li",null,"问题-答案/ 用户-答案 一对多关系")],-1),Cn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 答案模型"),s(`
`),n("span",{class:"token keyword"},"const"),s(" mongoose "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'mongoose'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" Schema"),n("span",{class:"token punctuation"},","),s(" model "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` mongoose

`),n("span",{class:"token keyword"},"const"),s(" AnswerSchema "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Schema"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token literal-property property"},"__v"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Number"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 答案内容"),s(`
  `),n("span",{class:"token literal-property property"},"content"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 答案的创建者"),s(`
  `),n("span",{class:"token literal-property property"},"answerer"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'User'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 答案的问题"),s(`
  `),n("span",{class:"token literal-property property"},"questionId"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 答案的点赞数"),s(`
  `),n("span",{class:"token literal-property property"},"voteCount"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Number"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"default"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"0"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"model"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'Answer'"),n("span",{class:"token punctuation"},","),s(" AnswerSchema"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Ln=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 答案控制器"),s(`
`),n("span",{class:"token keyword"},"const"),s(" Answer "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../models/answers'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"AnswersCtl"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// 答案列表"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" per_page "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"10"),s(),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s(`query
    `),n("span",{class:"token keyword"},"const"),s(" page "),n("span",{class:"token operator"},"="),s(" Math"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"max"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("query"),n("span",{class:"token punctuation"},"."),s("page "),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token number"},"1"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" perPage "),n("span",{class:"token operator"},"="),s(" Math"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"max"),n("span",{class:"token punctuation"},"("),s("per_page "),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" q "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"RegExp"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("query"),n("span",{class:"token punctuation"},"."),s("q"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Answer"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"content"),n("span",{class:"token operator"},":"),s(" q"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"questionId"),n("span",{class:"token operator"},":"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("questionId"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"limit"),n("span",{class:"token punctuation"},"("),s("perPage"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"skip"),n("span",{class:"token punctuation"},"("),s("page "),n("span",{class:"token operator"},"*"),s(" perPage"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 根据id查询答案"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" answer "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Answer"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"populate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'answerer'"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` answer
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 创建答案"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"create"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"verifyParams"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"content"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" answer "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Answer"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token operator"},"..."),s("ctx"),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s("body"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"answerer"),n("span",{class:"token operator"},":"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"questionId"),n("span",{class:"token operator"},":"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("questionId"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` answer
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 修改答案"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"update"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"verifyParams"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"content"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" answer "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Answer"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findByIdAndUpdate"),n("span",{class:"token punctuation"},"("),s(`
      ctx`),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},","),s(`
      ctx`),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s(`body
    `),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` answer
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 删除答案"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"delete"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" answer "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Answer"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findByIdAndRemove"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 检查答案是否存在"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"checkAnswerExist"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" answer "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Answer"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'+answerer'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("answer"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"404"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'答案不存在'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 检查答案是否是当前用户"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"checkAnswerer"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" answer "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Answer"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'+answerer'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("answer"),n("span",{class:"token punctuation"},"."),s("answerer"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"!=="),s(" ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"403"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'没有权限'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"AnswersCtl"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Hn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 答案路由"),s(`
`),n("span",{class:"token keyword"},"const"),s(" Router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-router'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" koajwt "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-jwt'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Router"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"prefix"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'/questions/:questionId/answers'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(`
  find`),n("span",{class:"token punctuation"},","),s(`
  findById`),n("span",{class:"token punctuation"},","),s(`
  create`),n("span",{class:"token punctuation"},","),s(`
  update`),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token keyword"},"delete"),n("span",{class:"token operator"},":"),s(" del"),n("span",{class:"token punctuation"},","),s(`
  checkAnswerExist`),n("span",{class:"token punctuation"},","),s(`
  checkAnswerer`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../controllers/answers'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" secret "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../config'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(" auth "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"koajwt"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" secret "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 获取答案列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" find"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 获取特定答案"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" checkAnswerExist"),n("span",{class:"token punctuation"},","),s(" findById"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 创建答案"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"post"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(" create"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 修改答案"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"patch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(" checkAnswerExist"),n("span",{class:"token punctuation"},","),s(" checkAnswerer"),n("span",{class:"token punctuation"},","),s(" update"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 删除答案"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"delete"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(" checkAnswerExist"),n("span",{class:"token punctuation"},","),s(" checkAnswerer"),n("span",{class:"token punctuation"},","),s(" del"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(` router
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),On=n("ul",null,[n("li",null,"赞同/踩 答案 （6 个接口，注意互斥）")],-1),zn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[s("  "),n("span",{class:"token comment"},"// 赞过的答案"),s(`
  `),n("span",{class:"token literal-property property"},"likingAnswers"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Answer'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token comment"},"// 踩过的答案"),s(`
  `),n("span",{class:"token literal-property property"},"dislikingAnswers"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Answer'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Mn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 获取用户的点赞列表"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"listLikingAnswers"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" user "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'+likingAnswers'"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"populate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'likingAnswers'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("user"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"404"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(" user"),n("span",{class:"token punctuation"},"."),s(`likingAnswers
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 点赞答案"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"likeAnswer"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" me "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'+likingAnswers'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("me"),n("span",{class:"token punctuation"},"."),s("likingAnswers"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"id"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" id"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"includes"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      me`),n("span",{class:"token punctuation"},"."),s("likingAnswers"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
      me`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
    `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 取消点赞答案"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"unlikeAnswer"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" me "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'+likingAnswers'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" index "),n("span",{class:"token operator"},"="),s(" me"),n("span",{class:"token punctuation"},"."),s(`likingAnswers
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"id"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" id"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"indexOf"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("index "),n("span",{class:"token operator"},">"),s(),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      me`),n("span",{class:"token punctuation"},"."),s("likingAnswers"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"splice"),n("span",{class:"token punctuation"},"("),s("index"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(`
      me`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 获取用户的踩列表"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"listDislikingAnswers"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" user "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'+dislikingAnswers'"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"populate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'dislikingAnswers'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("user"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"404"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(" user"),n("span",{class:"token punctuation"},"."),s(`dislikingAnswers
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 踩答案"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"dislikeAnswer"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ctx"),n("span",{class:"token punctuation"},","),s(" next")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" me "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),s(`
      `),n("span",{class:"token string"},"'+dislikingAnswers'"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s(`
      `),n("span",{class:"token operator"},"!"),s("me"),n("span",{class:"token punctuation"},"."),s("dislikingAnswers"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"id"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" id"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"includes"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      me`),n("span",{class:"token punctuation"},"."),s("dislikingAnswers"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
      me`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
    `),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"next"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 取消踩答案"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"undislikeAnswer"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" me "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),s(`
      `),n("span",{class:"token string"},"'+dislikingAnswers'"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" index "),n("span",{class:"token operator"},"="),s(" me"),n("span",{class:"token punctuation"},"."),s(`dislikingAnswers
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"id"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" id"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"indexOf"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("index "),n("span",{class:"token operator"},">"),s(),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      me`),n("span",{class:"token punctuation"},"."),s("dislikingAnswers"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"splice"),n("span",{class:"token punctuation"},"("),s("index"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(`
      me`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Nn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(`
  find`),n("span",{class:"token punctuation"},","),s(`
  findById`),n("span",{class:"token punctuation"},","),s(`
  create`),n("span",{class:"token punctuation"},","),s(`
  update`),n("span",{class:"token punctuation"},","),s(`
  del`),n("span",{class:"token punctuation"},","),s(`
  login`),n("span",{class:"token punctuation"},","),s(`
  checkOwner`),n("span",{class:"token punctuation"},","),s(`
  listFollowing`),n("span",{class:"token punctuation"},","),s(`
  listFollowers`),n("span",{class:"token punctuation"},","),s(`
  checkUserExist`),n("span",{class:"token punctuation"},","),s(`
  follow`),n("span",{class:"token punctuation"},","),s(`
  unfollow`),n("span",{class:"token punctuation"},","),s(`
  followTopic`),n("span",{class:"token punctuation"},","),s(`
  unfollowTopic`),n("span",{class:"token punctuation"},","),s(`
  listFollowingTopics`),n("span",{class:"token punctuation"},","),s(`
  listQuestions`),n("span",{class:"token punctuation"},","),s(`

  listLikingAnswers`),n("span",{class:"token punctuation"},","),s(`
  likeAnswer`),n("span",{class:"token punctuation"},","),s(`
  unlikeAnswer`),n("span",{class:"token punctuation"},","),s(`

  listDislikingAnswers`),n("span",{class:"token punctuation"},","),s(`
  dislikeAnswer`),n("span",{class:"token punctuation"},","),s(`
  undislikeAnswer`),n("span",{class:"token punctuation"},","),s(`

`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../controllers/users'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token operator"},"..."),s(`

`),n("span",{class:"token comment"},"// 用户点赞答案列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id/likingAnswers'"),n("span",{class:"token punctuation"},","),s(" listLikingAnswers"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 用户点赞答案"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"put"),n("span",{class:"token punctuation"},"("),s(`
  `),n("span",{class:"token string"},"'/likingAnswers/:id'"),n("span",{class:"token punctuation"},","),s(`
  authToken`),n("span",{class:"token punctuation"},","),s(`
  checkAnswerExist`),n("span",{class:"token punctuation"},","),s(`
  likeAnswer`),n("span",{class:"token punctuation"},","),s(`
  undislikeAnswer
`),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 用户取消点赞答案"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"delete"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/likingAnswers/:id'"),n("span",{class:"token punctuation"},","),s(" authToken"),n("span",{class:"token punctuation"},","),s(" checkAnswerExist"),n("span",{class:"token punctuation"},","),s(" unlikeAnswer"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 用户踩答案列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id/dislikingAnswers'"),n("span",{class:"token punctuation"},","),s(" listDislikingAnswers"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 用户踩答案"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"put"),n("span",{class:"token punctuation"},"("),s(`
  `),n("span",{class:"token string"},"'/dislikingAnswers/:id'"),n("span",{class:"token punctuation"},","),s(`
  authToken`),n("span",{class:"token punctuation"},","),s(`
  checkAnswerExist`),n("span",{class:"token punctuation"},","),s(`
  dislikeAnswer`),n("span",{class:"token punctuation"},","),s(`
  unlikeAnswer
`),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 用户取消踩答案"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"delete"),n("span",{class:"token punctuation"},"("),s(`
  `),n("span",{class:"token string"},"'/dislikingAnswers/:id'"),n("span",{class:"token punctuation"},","),s(`
  authToken`),n("span",{class:"token punctuation"},","),s(`
  checkAnswerExist`),n("span",{class:"token punctuation"},","),s(`
  undislikeAnswer
`),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Wn=n("ul",null,[n("li",null,"收藏答案")],-1),Gn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[s("  "),n("span",{class:"token comment"},"// 收藏的答案"),s(`
  `),n("span",{class:"token literal-property property"},"collectingAnswers"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Answer'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"select"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Dn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 获取用户的收藏列表"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"listCollectingAnswers"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" user "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'+collectingAnswers'"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"populate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'collectingAnswers'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("user"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"throw"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"404"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(" user"),n("span",{class:"token punctuation"},"."),s(`collectingAnswers
  `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token comment"},"// 收藏答案"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"collectAnswer"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" me "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),s(`
      `),n("span",{class:"token string"},"'+collectingAnswers'"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s(`
      `),n("span",{class:"token operator"},"!"),s("me"),n("span",{class:"token punctuation"},"."),s("collectingAnswers"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"id"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" id"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"includes"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      me`),n("span",{class:"token punctuation"},"."),s("collectingAnswers"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
      me`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 取消收藏答案"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"uncollectAnswer"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" me "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" User"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"select"),n("span",{class:"token punctuation"},"("),s(`
      `),n("span",{class:"token string"},"'+collectingAnswers'"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" index "),n("span",{class:"token operator"},"="),s(" me"),n("span",{class:"token punctuation"},"."),s(`collectingAnswers
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"id"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" id"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"indexOf"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("index "),n("span",{class:"token operator"},">"),s(),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      me`),n("span",{class:"token punctuation"},"."),s("collectingAnswers"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"splice"),n("span",{class:"token punctuation"},"("),s("index"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(`
      me`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Yn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token operator"},"..."),s(`
  listCollectingAnswers`),n("span",{class:"token punctuation"},","),s(`
  collectAnswer`),n("span",{class:"token punctuation"},","),s(`
  uncollectAnswer`),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../controllers/users'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token operator"},"..."),s(`

`),n("span",{class:"token comment"},"// 用户收藏答案列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id/collectingAnswers'"),n("span",{class:"token punctuation"},","),s(" listCollectingAnswers"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 用户收藏答案"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"put"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/collectingAnswers/:id'"),n("span",{class:"token punctuation"},","),s(" authToken"),n("span",{class:"token punctuation"},","),s(" checkAnswerExist"),n("span",{class:"token punctuation"},","),s(" collectAnswer"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 用户取消收藏答案"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"delete"),n("span",{class:"token punctuation"},"("),s(`
  `),n("span",{class:"token string"},"'/collectingAnswers/:id'"),n("span",{class:"token punctuation"},","),s(`
  authToken`),n("span",{class:"token punctuation"},","),s(`
  checkAnswerExist`),n("span",{class:"token punctuation"},","),s(`
  uncollectAnswer
`),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Qn=n("h2",{id:"评论模块",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#评论模块","aria-hidden":"true"},"#"),s(" 评论模块")],-1),Fn=n("ul",null,[n("li",null,"评论的增删改查"),n("li",null,"答案-评论/问题-评论/用户-评论 一对多关系"),n("li",null,"一级评论与二级评论 (增加连个字段，replyTo, rootCommentId)")],-1),Jn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 评论模型"),s(`
`),n("span",{class:"token keyword"},"const"),s(" mongoose "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'mongoose'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" Schema"),n("span",{class:"token punctuation"},","),s(" model "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` mongoose

`),n("span",{class:"token keyword"},"const"),s(" CommentSchema "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Schema"),n("span",{class:"token punctuation"},"("),s(`
  `),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// 评论的内容"),s(`
    `),n("span",{class:"token literal-property property"},"content"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token comment"},"// 评论的创建者"),s(`
    `),n("span",{class:"token literal-property property"},"commentator"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'User'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token comment"},"// 评论的问题"),s(`
    `),n("span",{class:"token literal-property property"},"questionId"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token comment"},"// 评论的答案"),s(`
    `),n("span",{class:"token literal-property property"},"answerId"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token comment"},"// 评论的点赞数"),s(`
    `),n("span",{class:"token literal-property property"},"voteCount"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Number"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"default"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"0"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token comment"},"// 评论的回复"),s(`
    `),n("span",{class:"token literal-property property"},"replyTo"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" Schema"),n("span",{class:"token punctuation"},"."),s("Types"),n("span",{class:"token punctuation"},"."),s("ObjectId"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"ref"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'User'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token comment"},"// 根评论"),s(`
    `),n("span",{class:"token literal-property property"},"rootCommentId"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(" String "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"timestamps"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"model"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'Comment'"),n("span",{class:"token punctuation"},","),s(" CommentSchema"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Vn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 评论控制器"),s(`
`),n("span",{class:"token keyword"},"const"),s(" Comment "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../models/comments'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"CommentsCtl"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// 评论列表"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" per_page "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"10"),s(),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s(`query
    `),n("span",{class:"token keyword"},"const"),s(" page "),n("span",{class:"token operator"},"="),s(" Math"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"max"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("query"),n("span",{class:"token punctuation"},"."),s("page "),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token number"},"1"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" perPage "),n("span",{class:"token operator"},"="),s(" Math"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"max"),n("span",{class:"token punctuation"},"("),s("per_page "),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" q "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"RegExp"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("query"),n("span",{class:"token punctuation"},"."),s("q"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" rootCommentId"),n("span",{class:"token punctuation"},","),s(" replyTo "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s(`query
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Comment"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"content"),n("span",{class:"token operator"},":"),s(" q"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"questionId"),n("span",{class:"token operator"},":"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("questionId"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"answerId"),n("span",{class:"token operator"},":"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("answerId"),n("span",{class:"token punctuation"},","),s(`
      rootCommentId`),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"limit"),n("span",{class:"token punctuation"},"("),s("perPage"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"skip"),n("span",{class:"token punctuation"},"("),s("page "),n("span",{class:"token operator"},"*"),s(" perPage"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"populate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'commentator replyTo'"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 根据id查询评论"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" comment "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Comment"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findById"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"populate"),n("span",{class:"token punctuation"},"("),s(`
      `),n("span",{class:"token string"},"'commentator'"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` comment
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 创建评论"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"create"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"verifyParams"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"content"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"rootCommentId"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"replyTo"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" comment "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Comment"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token operator"},"..."),s("ctx"),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s("body"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"commentator"),n("span",{class:"token operator"},":"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("state"),n("span",{class:"token punctuation"},"."),s("user"),n("span",{class:"token punctuation"},"."),s("_id"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"questionId"),n("span",{class:"token operator"},":"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("questionId"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"answerId"),n("span",{class:"token operator"},":"),s(" ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("answerId"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"save"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` comment
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 修改评论"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token function"},"update"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"verifyParams"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"content"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"type"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'string'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token literal-property property"},"required"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" content "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(" ctx"),n("span",{class:"token punctuation"},"."),s("request"),n("span",{class:"token punctuation"},"."),s(`body
    `),n("span",{class:"token keyword"},"const"),s(" comment "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Comment"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findByIdAndUpdate"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},","),s(" content"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("body "),n("span",{class:"token operator"},"="),s(` comment
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 删除评论"),s(`
  `),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token keyword"},"delete"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" comment "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" Comment"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"findByIdAndRemove"),n("span",{class:"token punctuation"},"("),s("ctx"),n("span",{class:"token punctuation"},"."),s("params"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},")"),s(`
    ctx`),n("span",{class:"token punctuation"},"."),s("status "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"204"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"CommentsCtl"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Zn=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token comment"},"// 评论路由"),s(`
`),n("span",{class:"token keyword"},"const"),s(" Router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-router'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" koajwt "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'koa-jwt'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" secret "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../config'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" router "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Router"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token literal-property property"},"prefix"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'/questions/:questionId/answers/:answerId/comments'"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(" auth "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"koajwt"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(" secret "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(`
  find`),n("span",{class:"token punctuation"},","),s(`
  findById`),n("span",{class:"token punctuation"},","),s(`
  create`),n("span",{class:"token punctuation"},","),s(`
  update`),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token keyword"},"delete"),n("span",{class:"token operator"},":"),s(" del"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'../controllers/comments'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 获取评论列表"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" find"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 获取特定评论"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" findById"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 创建评论"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"post"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},","),s(" create"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 修改评论"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"patch"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(" update"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token comment"},"// 删除评论"),s(`
router`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"delete"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/:id'"),n("span",{class:"token punctuation"},","),s(" auth"),n("span",{class:"token punctuation"},","),s(" del"),n("span",{class:"token punctuation"},")"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(` router
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),Kn=n("ul",null,[n("li",null,"评论的点赞与踩 (略)")],-1),Xn=n("h2",{id:"参考资料",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#参考资料","aria-hidden":"true"},"#"),s(" 参考资料")],-1),$n={href:"https://coding.imooc.com/class/chapter/354.html#Anchor",target:"_blank",rel:"noopener noreferrer"},ns={href:"https://www.bilibili.com/video/BV13P4y1Z7dj/?is_story_h5=false&p=1&share_from=ugc&share_medium=android&share_plat=android&share_session_id=671f7e3e-01e3-4fb7-a547-3733667aef0f&share_source=COPY&share_tag=s_i&timestamp=1664799542&unique_k=zHn511M&vd_source=c5abf1ba032ca00c06ebba96e3ff445e",target:"_blank",rel:"noopener noreferrer"},ss={href:"https://zhuanlan.zhihu.com/p/334809573",target:"_blank",rel:"noopener noreferrer"};function as(ts,es){const e=p("CodeGroupItem"),o=p("CodeGroup"),c=p("ExternalLinkIcon");return u(),i("div",null,[k,d,a(o,null,{default:t(()=>[a(e,{title:"package.json"},{default:t(()=>[m]),_:1})]),_:1}),b,v,a(o,null,{default:t(()=>[a(e,{title:"koa 中间件执行顺序"},{default:t(()=>[y]),_:1})]),_:1}),g,f,a(o,null,{default:t(()=>[a(e,{title:"koa-router 使用"},{default:t(()=>[w]),_:1})]),_:1}),h,x,a(o,null,{default:t(()=>[a(e,{title:"目录重构 app/index.js"},{default:t(()=>[_,a(e,{title:"目录重构 routes/index.js"},{default:t(()=>[T]),_:1})]),_:1}),a(e,{title:"目录重构 routes/users.js"},{default:t(()=>[j]),_:1}),a(e,{title:"目录重构 routes/home.js"},{default:t(()=>[A]),_:1})]),_:1}),q,a(o,null,{default:t(()=>[a(e,{title:"目录重构 controllers/home.js"},{default:t(()=>[E]),_:1}),a(e,{title:"目录重构 routes/home.js"},{default:t(()=>[S]),_:1}),a(e,{title:"目录重构 controllers/users.js"},{default:t(()=>[B]),_:1}),a(e,{title:"目录重构 routes/users.js"},{default:t(()=>[I]),_:1})]),_:1}),U,n("ul",null,[n("li",null,[n("a",P,[s("mongodb"),a(c)]),s(" 申请云数据库，也可以本地安装"),R]),n("li",null,[n("a",C,[s("mongoose 文档"),a(c)])])]),a(o,null,{default:t(()=>[a(e,{title:"app/config.js"},{default:t(()=>[L]),_:1}),a(e,{title:"app/index.js"},{default:t(()=>[H]),_:1}),a(e,{title:"models/users.js"},{default:t(()=>[O]),_:1}),a(e,{title:"controllers/users.js"},{default:t(()=>[z]),_:1})]),_:1}),M,N,a(o,null,{default:t(()=>[a(e,{title:"controllers/users.js"},{default:t(()=>[W]),_:1}),a(e,{title:"routes/users.js"},{default:t(()=>[G]),_:1})]),_:1}),D,Y,a(o,null,{default:t(()=>[a(e,{title:"example.http"},{default:t(()=>[Q]),_:1})]),_:1}),F,J,a(o,null,{default:t(()=>[a(e,{title:"app/index.js"},{default:t(()=>[V]),_:1}),a(e,{title:"controllers/home.js"},{default:t(()=>[Z]),_:1}),a(e,{title:"routes/home.js"},{default:t(()=>[K]),_:1}),a(e,{title:"example.http"},{default:t(()=>[X]),_:1})]),_:1}),$,nn,a(o,null,{default:t(()=>[a(e,{title:"models/users.js"},{default:t(()=>[sn]),_:1}),a(e,{title:"example.http 修改资料与个人详情 添加字段"},{default:t(()=>[an]),_:1}),a(e,{title:"controllers/users.js 筛选字段"},{default:t(()=>[tn]),_:1})]),_:1}),en,on,a(o,null,{default:t(()=>[a(e,{title:"models/users.js"},{default:t(()=>[cn]),_:1}),a(e,{title:"controllers/users.js"},{default:t(()=>[pn]),_:1}),a(e,{title:"routes/users.js"},{default:t(()=>[ln]),_:1}),a(e,{title:"example.http"},{default:t(()=>[un]),_:1})]),_:1}),rn,kn,a(o,null,{default:t(()=>[a(e,{title:"models/topics.js"},{default:t(()=>[dn]),_:1}),a(e,{title:"controllers/topics.js"},{default:t(()=>[mn]),_:1}),a(e,{title:"routes/topics.js"},{default:t(()=>[bn]),_:1}),a(e,{title:"example.http"},{default:t(()=>[vn]),_:1})]),_:1}),yn,a(o,null,{default:t(()=>[a(e,{title:"models/users.js"},{default:t(()=>[gn]),_:1}),a(e,{title:"controllers/users.js"},{default:t(()=>[fn]),_:1}),a(e,{title:"routes/users.js"},{default:t(()=>[wn]),_:1}),a(e,{title:"controllers/topics.js"},{default:t(()=>[hn]),_:1}),a(e,{title:"routes/topics.js"},{default:t(()=>[xn]),_:1}),a(e,{title:"example.http"},{default:t(()=>[_n]),_:1})]),_:1}),Tn,jn,a(o,null,{default:t(()=>[a(e,{title:"models/users.js"},{default:t(()=>[An]),_:1}),a(e,{title:"models/Questions.js"},{default:t(()=>[qn]),_:1}),a(e,{title:"constrollers/questions.js"},{default:t(()=>[En]),_:1}),a(e,{title:"routes/questions.js"},{default:t(()=>[Sn]),_:1})]),_:1}),a(o,null,{default:t(()=>[a(e,{title:"controllers/topics.js"},{default:t(()=>[Bn]),_:1}),a(e,{title:"routes/topics.js"},{default:t(()=>[In]),_:1}),a(e,{title:"example.http"},{default:t(()=>[Un]),_:1})]),_:1}),Pn,Rn,a(o,null,{default:t(()=>[a(e,{title:"models/answers.js"},{default:t(()=>[Cn]),_:1}),a(e,{title:"controllers/answers.js"},{default:t(()=>[Ln]),_:1}),a(e,{title:"routes/answers.js"},{default:t(()=>[Hn]),_:1})]),_:1}),On,a(o,null,{default:t(()=>[a(e,{title:"models/users.js"},{default:t(()=>[zn]),_:1}),a(e,{title:"controllers/users.js"},{default:t(()=>[Mn]),_:1}),a(e,{title:"routes/users.js"},{default:t(()=>[Nn]),_:1})]),_:1}),Wn,a(o,null,{default:t(()=>[a(e,{title:"models/users.js"},{default:t(()=>[Gn]),_:1}),a(e,{title:"controllers/users.js"},{default:t(()=>[Dn]),_:1}),a(e,{title:"routes/users.js"},{default:t(()=>[Yn]),_:1})]),_:1}),Qn,Fn,a(o,null,{default:t(()=>[a(e,{title:"models/comments.js"},{default:t(()=>[Jn]),_:1}),a(e,{title:"controllers/comments.js"},{default:t(()=>[Vn]),_:1}),a(e,{title:"routes/comments.js"},{default:t(()=>[Zn]),_:1})]),_:1}),Kn,Xn,n("ul",null,[n("li",null,[n("a",$n,[s("Node.js 仿知乎服务端-深入理解 RESTful API"),a(c)])]),n("li",null,[n("a",ns,[s("Express 版本 知乎 api"),a(c)])]),n("li",null,[n("a",ss,[s("一文搞懂什么是 RESTful API"),a(c)])])])])}const cs=l(r,[["render",as],["__file","index.html.vue"]]);export{cs as default};
